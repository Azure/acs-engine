{
    "apiVersion": "v1",
    "clusters": [
        {
            "cluster": {
                "certificate-authority-data": "{{WrapAsVerbatim "variables('caCertificate')"}}",
{{if NoPublicIP }}
                "server": "https://{{WrapAsVerbatim "reference(concat('Microsoft.Network/loadBalancers/', variables('masterLbName'))).frontendIPConfigurations.privateIPAddress"}}"
{{else}}
                "server": "https://{{WrapAsVerbatim "reference(concat('Microsoft.Network/publicIPAddresses/', variables('masterPublicIPAddressName'))).dnsSettings.fqdn"}}"
{{end}}
            },
            "name": "{{WrapAsVariable "resourceGroup"}}"
        }
    ],
    "contexts": [
        {
            "context": {
                "cluster": "{{WrapAsVariable "resourceGroup"}}",
                "user": "{{WrapAsVariable "resourceGroup"}}-admin"
            },
            "name": "{{WrapAsVariable "resourceGroup"}}"
        }
    ],
    "current-context": "{{WrapAsVariable "resourceGroup"}}",
    "kind": "Config",
    "users": [
        {
            "name": "{{WrapAsVariable "resourceGroup"}}-admin",
            "user": {
                "client-certificate-data": "{{WrapAsVerbatim "variables('kubeConfigCertificate')"}}",
                "client-key-data": "{{WrapAsVerbatim "variables('kubeConfigPrivateKey')"}}"
            }
        }
    ]
}
